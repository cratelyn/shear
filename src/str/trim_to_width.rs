// TODO: trim to fit a visual width, not a length in bytes.
